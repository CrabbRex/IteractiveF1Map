<!doctype html>
<html>
    <head>
    <meta charset="utf-8">
    <title>InteractiveF1</title>
    <link href="style.css" rel="stylesheet" />
    <script src="https://maps.google.com/maps/api/js?key=AIzaSyC1kwdCPHCWJj-OUiKT1bwazL37BXS6sqg"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://mmcc.mq.edu.au/mmcc2041/resources/week8/jquery.ui.map.full.min.js"></script>
    <script>
        $(document).ready(function() { 
            let arrowOffSet = 0;
            var mapShowing = true;
            let myMap = $('#myMap').gmap({
                'zoom': 1.9,
                'MapTypeId': google.maps.MapTypeId.TERRAIN
            }).gmap('get', 'map');

            //called when marker is clicked
            function updatePage(showId) {
                if(mapShowing) {
                    $('#myMap').show();
                    $('.circuitInfo').hide();
                    $('#body').addClass('body');
                }
                else{
                    $('#body').addClass('bodyMapNotShowing');
                    $('#myMap').hide();
                    $('#Winner').hide();
                    $('#' + showId).show();
                    let triggerElement = $('.Arrow');
                    arrowOffSet = triggerElement.offset().top + 1;
                }
            }
            $('#body').addClass('body');
            $('#fastestLap').hide();
            $('.circuitInfo').hide();

            function addMarker(position, circuitId) {
                $('#myMap').gmap('addMarker', {'position': position}).click(function() {
                    var markerPos = new google.maps.LatLng(position.split(',')[0], position.split(',')[1]);
                    $('#tutorial').slideUp(); //If tutorial not closed by marker clicked, auto close tutorial.
                    smoothZoom(myMap, 14.5, myMap.getZoom(), markerPos, circuitId);
                    mapShowing = false;
                });
            }
            addMarker('26.0321,50.5108', 'bahrain');
            addMarker('21.63194, 39.1044', 'saudiArabia');
            addMarker('47.21972, 14.76472', 'austria');
            addMarker('-37.8470, 144.9740', 'australia');
            addMarker('34.8417, 136.5389', 'japan');
            addMarker('31.338889, 121.219722', 'china');
            addMarker('25.958056, -80.238889', 'miami');
            addMarker('44.341111, 11.713333', 'imola');
            addMarker('43.734722, 7.420556', 'monaco');
            addMarker('45.500556, -73.5225', 'canada');
            addMarker('41.57015000859392, 2.2581662238152087', 'spain');
            addMarker('52.069479725314835, -1.0223525375649898', 'britain');
            addMarker('47.57988934203045, 19.247394539664125', 'hunargy');
            addMarker('50.442190512081545, 5.96686326186287', 'belgium');
            addMarker('52.38915327473617, 4.54021685255138', 'netherlands');
            addMarker('45.61768409264565, 9.281191844130136', 'monza');
            addMarker('40.373336753627285, 49.853121765036526', 'baku');
            addMarker('30.13293099150061, -97.64047687456215', 'austin');
            addMarker('19.40572606849136, -99.09260911904308', 'mexico');
            addMarker('-23.70454316404402, -46.69920944869672', 'brazil');
            addMarker('36.11000572950081, -115.16194624550671', 'vegas');
            addMarker('25.488765723411916, 51.450521254127864', 'qatar');
            addMarker('24.469924007404288, 54.60563723875567', 'abuDhabi');
            //Recursively call smoothZoom to zoom in 0.5 at a time
            function smoothZoom(map, maxZoom, curZoom, pos, circuitId){
                if(curZoom >= maxZoom){
                    setTimeout(function(){
                        updatePage(circuitId);
                        return;
                    }, 2000);
                }
                else{
                    var newZoom = curZoom + 0.5;
                    map.setZoom(newZoom);
                    map.setCenter(pos);
                    setTimeout(function(){
                        smoothZoom(map, maxZoom, newZoom, pos, circuitId);
                    }, 150);
                }
            }
            $('#tutorialButton').click(function (){
                $('#tutorial').slideUp();
            })
            
            //Reopen Map BUTTON:
            $('#reopenMap').click(function(){
                mapShowing = true;
                $('.circuitInfo').hide();
                $('#myMap').show();
                myMap.setZoom(1.9);
                myMap.setCenter();
            })
            $('.exitButton').click(function(){
                mapShowing = true;
                $('.circuitInfo').hide();
                $('#myMap').show();
                myMap.setZoom(1.9);
                myMap.setCenter();
                $(window).scrollTop(0);
                $('#body').css({
                    height: '1vh'
                });
                $('#bodyMapNotShowing').css({
                    height: '1vh'
                });
            })

            $('#findOut').click(function() {
                $('#Winner').show();
                $('#findOut').hide();
            })
            
            $(document).scroll(function() {
                
                let triggerPoint = arrowOffSet + (($(window).height())/2);
                let windowHeight = $(window).height();
                var scrollTop = $(this).scrollTop();
                console.log("SCROLLTOP: " + $(this).scrollTop());
                console.log("offset: " + arrowOffSet);
                console.log("triggerpoint: " + triggerPoint);
                console.log("Window H/2: " + $(window).height()/2);
                console.log($('#fastestLap').height());
                //////////////////////////////////////////////////////
                if(scrollTop >= 625 && scrollTop <= 3338){
                    $('.Arrow').addClass('fixed');
                }
                else {
                    $('.Arrow').removeClass('fixed');
                }

                if(scrollTop >= 3875 && scrollTop < 7025){
                    $('.Charles').addClass('CharlesFixed');
                }
                else{
                    $('.Charles').removeClass('CharlesFixed');
                }
                if(scrollTop > 7025){
                    $('#fastestLap')[0].pause();
                    $('#fastestLap').hide();
                }
            })


            $('.Charles').click(function() {
                $('#fastestLap').show();
                $('#fastestLap')[0].play();
                //Start Video.
                //Video Controls.

            })

            })
    </script>
    </head>
<body id="body">
    <div class="banner">
        <h1>Interactive F1 Map!</h1>
        <button id="reopenMap">Choose Again!</button>
    </div>

    <div id="tutorial">
        <p style="color: red"><u>Welcome to the Interactive F1 Map!</u></p>
        <p>This map is for the current 2024 Formula 1 Season and includes all 24 race venues.</p>
        <p></p>
        <p>Here's how it works: </p>
        <p>1. Pick your favourite race on the Formula 1 calendar using the Interactive Map.</p>
        <p>2. Scroll down to find out more about your favourite track.</p>
        <p>3. If you want to choose a new track, use the button in the top right, or scroll to the end.</p>
        <p></p>
        <p>Have Fun!</p>
        <button id="tutorialButton">Get Started!</button>
    </div>

    <div id="myMap"></div>

    <div id="australia" class="circuitInfo">
        <h2>Australian Grand Prix</h2>
        <img src="assets/Australia_Circuit.jpg" class="circuit">
        <h3>Scroll Down For More Info!</h3>
        <!-- Credit: Arrow AI Generated by ChatGPT -->
        <img src="assets/ARROW.png" class="Arrow">
        <p id="p1" class="introText">The Australian Grand Prix is held at the <u style="color: red">Albert Park Circuit.</u></p>
        <p id="p2" class="introText">The first race at the Albert Park crcuit was in 1988.</p>
        <p id="p3" class="introText">
            Want to see who got the fastest lap at this circuit?<br> Keep Scrolling!
        </p>
       
        <video id="fastestLap" controls width="1000">
             <source src="assets/AusLap.mp4">
        </video>
        <img src="assets/CharlesPhoto.png" class="Charles">
        <p id="p4" class="CharlesText">I'm Charles Leclerc</p>
        <p id="p5" class="CharlesText">In 2022 I set the fastest lap ever<br> recorded at the Albert Park Circuit!</p>
        <p id="p6" class="CharlesText">Do you want to see it?</p>
        <p id="p7" class="CharlesText">Click on me!</p>
            <!-- <caption>Charles Leclerc</caption> -->
        <div id="mostWins">
            <p id="p8">Can you guess who has the most wins at the Albert Park Circuit?</p>
            <p id="p9">They have 7 World Championships!</p>
            <p id="p10">They drove for Jordan, Benetton, Ferarri & Mercedes</p>
            <p id="p11">Got a Guess?</p>
            <button id="findOut">Click here to find out!</button>
            <!-- image source: https://thefederal.com/sports/25-years-of-michael-schumachers-formula-one-world-title-legacy/ -->
            
        </div>
        <div id="Winner">
            <img src="assets/Michael_Schumacher_(Ferrari)_-_GP_d'Italia_1998.jpg" id="Wins">
            <p id="p12">Michael Schumacher!</p>
            <p id="p13">Fund out more about him <a href="https://www.formula1.com/en/information/drivers-hall-of-fame-michael-schumacher.7KdX5nJlTG55vR5JQSbZ21" target="_blank">here!</a></p>
        </div>
        <footer>
            <p>Want more from Albert Park Circuit?</p>
            <p id="fp2">Watch last years race highlights here: </p>
        </footer>
        <button class="exitButton">Pick Another Track Here!</button>
    </div>

    <div id="bahrain" class="circuitInfo">
        <h2>Bahrain Grand Prix</h2>
        <img src="assets/Bahrain_Circuit.avif">
        <h3>Scroll Down For More Info!</h3>
        <!-- Credit: Arrow AI Generated by ChatGPT -->
        <img src="assets/ARROW.png" class="Arrow">
        <p id="p1">The Bahrain Grand Prix is held at the Bahrain International Circuit.</p>
        <p id="p2">The first race at the Albert Park crcuit was in 2004.</p>
        <p id="p3">
            Want to see who got the fastest lap at this circuit?<br> Keep Scrolling!
        </p>
    </div>
</body>
</html>

<!-- IDEAS:
 Here is a video of the fastest lap EVER recorded at the circuit.<br>
            Set by Charles Leclerc in 2022.
        - Fastest Lap - "Want to see my fastest lap? Click me!"
        - Most wins
        - Here's what last years grid looked like.
        - Want to watch the race highlights? Click here.
        - Pick Another Track!